<!doctype html>
<html lang="vi">
<head>
  <meta charset="utf-8" />
  <title>{{ title }}</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>
  <div class="container">
    <div class="header">
      <h1>{{ title }}</h1>
      <div class="meta">
        <div><b>Thời gian tạo:</b> {{ summary.generated_at }}</div>
        <div><b>Số dòng:</b> {{ summary.rows }} | <b>Số cột:</b> {{ summary.cols }} | <b>Thiếu dữ liệu:</b> {{ summary.missing_total }}</div>
      </div>

      <div class="actions">
        <a class="btn" href="/">Upload CSV khác</a>
        <a class="btn primary" href="/download/{{ file_id }}.pdf">Tải PDF</a>
      </div>
    </div>

    <div class="section">
      <h2>1) Mô tả</h2>
      <p>
        Báo cáo này được sinh tự động từ file CSV bằng Python (Pandas + Matplotlib + pdfkit).
        Nội dung gồm: bảng dữ liệu (30 dòng đầu), thống kê mô tả, biểu đồ minh họa và kết luận ngắn.
      </p>
    </div>

    <div class="section">
      <h2>2) Bảng dữ liệu (Preview)</h2>
      <div class="table-wrap">
        {{ preview_table_html | safe }}
      </div>
      <div class="note">* Chỉ hiển thị 30 dòng đầu để tránh PDF quá dài.</div>
    </div>

    <div class="section">
      <h2>3) Thống kê mô tả</h2>
      {% if desc_table_html %}
        <div class="table-wrap">
          {{ desc_table_html | safe }}
        </div>
      {% else %}
        <p class="note">Không có cột số (numeric) để tạo bảng thống kê mô tả.</p>
      {% endif %}
    </div>

    <div class="section">
      <h2>4) Biểu đồ minh họa</h2>
      {% if chart_url %}
        <img class="chart" src="{{ chart_url }}" alt="chart" />
      {% else %}
        <p class="note">Không đủ cột phù hợp để vẽ biểu đồ.</p>
      {% endif %}
    </div>

    <div class="section">
      <h2>5) Kết luận ngắn</h2>
      <ul>
        <li>Dữ liệu có {{ summary.rows }} dòng và {{ summary.cols }} cột.</li>
        <li>Tổng số ô thiếu dữ liệu: {{ summary.missing_total }}.</li>
        <li>Khuyến nghị: kiểm tra outlier, chuẩn hóa dữ liệu và chọn mô hình phù hợp cho bài toán.</li>
      </ul>
    </div>

    <div class="footer">
      <div>© Báo cáo cá nhân - Generated by Flask App</div>
    </div>
  </div>
</body>
</html>
